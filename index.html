<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Eş Anlamlı Çarkıfelek 🎡</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Quicksand', sans-serif;
            touch-action: manipulation; /* Prevents double-tap zoom on mobile */
        }
        #wheel-container {
            position: relative;
            width: 90vw;
            height: 90vw;
            max-width: 450px;
            max-height: 450px;
        }
        #wheel {
            width: 100%;
            height: 100%;
            transition: transform 6s cubic-bezier(0.25, 1, 0.5, 1);
        }
        #pointer {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 30px solid #ef4444; /* red-500 */
            z-index: 10;
        }
        #spin-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: white;
            color: #4f46e5; /* indigo-600 */
            border: 6px solid #e0e7ff; /* indigo-200 */
            font-weight: 700;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            cursor: pointer;
        }
         #spin-button:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }
        #modal-overlay {
            transition: opacity 0.3s ease-in-out;
        }
        #modal-content {
            transition: transform 0.3s ease-in-out;
        }
    </style>
</head>
<body class="bg-indigo-50 flex flex-col items-center justify-center min-h-screen p-4">

    <main class="bg-white rounded-2xl shadow-xl p-4 sm:p-8 w-full max-w-lg text-center">
        
        <header class="mb-4">
            <h1 class="text-3xl sm:text-4xl font-bold text-indigo-600">Eş Anlamlı Çarkıfelek</h1>
            <p id="score" class="text-gray-500 mt-1 text-lg">Puan: <span id="score-value" class="font-bold">0</span></p>
        </header>

        <div id="wheel-container" class="mx-auto my-6">
            <div id="pointer"></div>
            <canvas id="wheel"></canvas>
            <button id="spin-button">ÇEVİR</button>
        </div>
        
        <button id="reset-button" class="bg-indigo-600 text-white font-bold py-3 px-8 rounded-full hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-300 transition-all duration-300 transform hover:scale-105">
            Oyunu Sıfırla
        </button>

    </main>

    <!-- Question Modal -->
    <div id="modal-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden opacity-0">
        <div id="modal-content" class="bg-white rounded-2xl shadow-xl p-8 w-full max-w-md text-center transform scale-95">
            <h2 class="text-2xl font-bold text-gray-800 mb-2">Soru</h2>
            <p class="text-lg mb-6">"<span id="question-word" class="font-bold text-indigo-600"></span>" kelimesinin eş anlamlısı nedir?</p>
            <div id="options-container" class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                <!-- Options will be generated here -->
            </div>
            <p id="feedback" class="mt-4 h-6 font-semibold"></p>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const wordData = {
            'Öğrenci': 'Talebe', 'Hekim': 'Doktor', 'Sene': 'Yıl', 'Hediye': 'Armağan',
            'Siyah': 'Kara', 'Cevap': 'Yanıt', 'Kalp': 'Yürek', 'Vatan': 'Yurt',
            'Ulus': 'Millet', 'Konut': 'Ev', 'Sual': 'Soru', 'İhtiyar': 'Yaşlı'
        };

        const canvas = document.getElementById('wheel');
        const spinButton = document.getElementById('spin-button');
        const resetButton = document.getElementById('reset-button');
        const scoreValue = document.getElementById('score-value');

        // Modal elements
        const modalOverlay = document.getElementById('modal-overlay');
        const modalContent = document.getElementById('modal-content');
        const questionWord = document.getElementById('question-word');
        const optionsContainer = document.getElementById('options-container');
        const feedback = document.getElementById('feedback');

        let segments = [];
        let currentRotation = 0;
        let isSpinning = false;
        let score = 0;
        const wheelColors = ["#6366f1", "#818cf8", "#a5b4fc", "#c7d2fe", "#3b82f6", "#60a5fa", "#93c5fd", "#bfdbfe", "#ec4899", "#f472b6", "#f9a8d4", "#fbcfe8"];
        const optionColors = [
            "bg-teal-500 hover:bg-teal-600", "bg-sky-500 hover:bg-sky-600",
            "bg-amber-500 hover:bg-amber-600", "bg-rose-500 hover:bg-rose-600"
        ];

        const ctx = canvas.getContext('2d');
        const PI2 = Math.PI * 2;

        function resizeCanvas() {
            const container = document.getElementById('wheel-container');
            const size = Math.min(container.clientWidth, container.clientHeight);
            canvas.width = size;
            canvas.height = size;
            drawWheel();
        }

        function setupGame() {
            segments = Object.keys(wordData).map((word, index) => ({
                word: word,
                color: wheelColors[index % wheelColors.length],
                completed: false
            }));
            score = 0;
            scoreValue.textContent = score;
            currentRotation = 0;
            canvas.style.transform = `rotate(0deg)`;
            spinButton.disabled = false;
            resizeCanvas();
        }

        function drawWheel() {
            if (!ctx) return;
            const numSegments = segments.length;
            const angleStep = PI2 / numSegments;
            const radius = canvas.width / 2;

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.save();
            ctx.translate(radius, radius);

            segments.forEach((segment, i) => {
                const startAngle = i * angleStep;
                const endAngle = (i + 1) * angleStep;
                
                ctx.beginPath();
                ctx.moveTo(0, 0);
                ctx.arc(0, 0, radius, startAngle, endAngle);
                ctx.closePath();
                
                ctx.fillStyle = segment.completed ? '#e5e7eb' : segment.color; // gray-200 if completed
                ctx.fill();
                ctx.stroke();

                // Draw text
                ctx.save();
                ctx.rotate(startAngle + angleStep / 2);
                ctx.textAlign = 'right';
                ctx.fillStyle = segment.completed ? '#9ca3af' : 'white';
                ctx.font = `bold ${radius * 0.08}px Quicksand`;
                ctx.fillText(segment.word, radius * 0.9, 10);
                ctx.restore();
            });
            ctx.restore();
        }

        function spin() {
            if (isSpinning) return;
            
            const availableSegments = segments.filter(s => !s.completed);
            if (availableSegments.length === 0) {
                alert("Tebrikler! Oyunu tamamladın!");
                return;
            }

            isSpinning = true;
            spinButton.disabled = true;

            const extraSpins = 5; // Full rotations for effect
            const randomStopIndex = Math.floor(Math.random() * segments.length);
            const segmentAngle = 360 / segments.length;
            const targetAngle = (randomStopIndex * segmentAngle) + (segmentAngle / 2);
            
            const finalRotation = (360 * extraSpins) + (360 - targetAngle);
            currentRotation += finalRotation;

            canvas.style.transform = `rotate(${currentRotation}deg)`;

            setTimeout(() => {
                isSpinning = false;
                const landedSegment = segments[randomStopIndex];
                if (landedSegment.completed) {
                    spinButton.disabled = false;
                } else {
                    showQuestion(landedSegment);
                }
            }, 6100); // Match transition duration + a little buffer
        }

        function showQuestion(segment) {
            const correctSynonym = wordData[segment.word];
            questionWord.textContent = segment.word;
            
            // Create options
            const allSynonyms = Object.values(wordData);
            let options = [correctSynonym];
            while (options.length < 4) {
                const randomSynonym = allSynonyms[Math.floor(Math.random() * allSynonyms.length)];
                if (!options.includes(randomSynonym)) {
                    options.push(randomSynonym);
                }
            }
            // Shuffle options
            for (let i = options.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [options[i], options[j]] = [options[j], options[i]];
            }
            
            // Shuffle colors
            const shuffledColors = [...optionColors].sort(() => Math.random() - 0.5);

            optionsContainer.innerHTML = '';
            options.forEach((opt, index) => {
                const button = document.createElement('button');
                button.textContent = opt;
                button.className = `text-white p-4 rounded-lg font-semibold transition-colors ${shuffledColors[index]}`;
                button.onclick = () => checkAnswer(opt, correctSynonym, segment);
                optionsContainer.appendChild(button);
            });
            
            feedback.textContent = '';
            modalOverlay.classList.remove('hidden');
            setTimeout(() => {
                modalOverlay.classList.remove('opacity-0');
                modalContent.classList.remove('scale-95');
            }, 10);
        }

        function checkAnswer(selected, correct, segment) {
            // Disable option buttons after one click
            Array.from(optionsContainer.children).forEach(btn => btn.disabled = true);

            if (selected === correct) {
                feedback.textContent = '🎉 Doğru!';
                feedback.className = 'mt-4 h-6 font-semibold text-green-600';
                score += 10;
                scoreValue.textContent = score;
                segment.completed = true;
            } else {
                feedback.textContent = '🤔 Yanlış! Doğrusu: ' + correct;
                feedback.className = 'mt-4 h-6 font-semibold text-red-500';
            }

            setTimeout(() => {
                closeModal();
                drawWheel();
                const availableSegments = segments.filter(s => !s.completed);
                if (availableSegments.length > 0) {
                    spinButton.disabled = false;
                } else {
                    setTimeout(() => alert(`🏆 Harika! Oyunu ${score} puanla bitirdin!`), 100);
                }
            }, 2000);
        }
        
        function closeModal() {
             modalOverlay.classList.add('opacity-0');
             modalContent.classList.add('scale-95');
             setTimeout(() => modalOverlay.classList.add('hidden'), 300);
        }

        window.addEventListener('resize', resizeCanvas);
        spinButton.addEventListener('click', spin);
        resetButton.addEventListener('click', setupGame);
        
        setupGame();
    });
    </script>
</body>
</html>
